{"version":3,"file":"environment.js","sources":["../sources/environment.mjs"],"sourcesContent":["const preferences = {\n  // classic: true,\n  // dynamic: true,\n};\n\nconst platform = (typeof navigator === 'object' && {\n  chrome: typeof chrome === 'object',\n  safari: /Version\\/.* Safari\\//.test(navigator.userAgent),\n}) || {node: typeof process === 'object' && process.versions && 'node' in process.versions};\n\nconst supports = (platform.supports = {\n  modules: platform.chrome || platform.safari,\n  static: platform.chrome,\n});\n\nconst MODULES = supports.modules && !preferences.classic; // platform.modules\nconst DYNAMIC = !supports.static || preferences.dynamic; // !MODULES || preferences.dynamic;\nconst OPTIONS = {type: MODULES ? 'module' : 'classic', platform, preferences};\n\nconst [, EXT] = /[^/]+(\\.m?js)/.exec(import.meta.url);\n\nconst {Log, CurrentScope} = Debugging();\n\nconst prefix = `languages/`;\nconst mappings = {};\n\nconst defaultBase = `${new URL(`.`, import.meta.url)}`;\n\nconst aliases = {\n  default: 'editor',\n  json: 'json',\n  jsonc: 'json',\n  css: 'css',\n  html: 'html',\n  js: 'ts',\n  javascript: 'ts',\n  ts: 'ts',\n  typescript: 'ts',\n};\n\nconst paths = {\n  editor: `monaco/editor.worker${EXT}`,\n  css: `${prefix}css/css.worker${EXT}`,\n  json: `${prefix}json/json.worker${EXT}`,\n  html: `${prefix}html/html.worker${EXT}`,\n  ts: `${prefix}ts/ts.worker${EXT}`,\n};\n\nconst resolve = (alias, base) => {\n  let mapping = mappings[alias];\n  if (!mapping) {\n    const name = aliases[alias] || 'editor';\n    mapping = mappings[alias] = `${new URL(`./${paths[name]}`, base || defaultBase)}`;\n  }\n  return mapping;\n};\n\nconst getWorker = (moduleID, label, base, dynamic = DYNAMIC) => {\n  const mode = aliases[label] || aliases.default;\n  const src = resolve(mode, base);\n  const url = getWorkerURL(base, src, dynamic);\n  const options = OPTIONS;\n  const worker = new Worker(url, options);\n  Log(() => ['getWorker(%o, %o) => %O', moduleID, label, {worker, mode, src, url, options}]);\n  return worker;\n};\n\nconst getWorkerURL = (base, src, dynamic = DYNAMIC) => {\n  return dynamic ? `${new URL(`./worker${EXT}`, base)}#${src.replace(base, '')}` : `${src}`;\n}\n\nvar environment = (base = defaultBase) => ({\n  base,\n  getWorker(moduleID, label) {\n    return getWorker(moduleID, label, this.base);\n  },\n});\n\nfunction Debugging() {\n  const {setPrototypeOf, defineProperties, defineProperty, freeze} = Object;\n  const debugging = {};\n  const namespace = {};\n  const noop = freeze(a => a);\n  const configurable = true;\n\n  Debugging = () => debugging;\n\n  const imports = import(`./debugging${EXT}`)\n    .then(imports => {\n      const descriptors = {};\n      for (const k in imports) descriptors[k] = {get: () => namespace[k], configurable};\n      defineProperties(debugging, descriptors);\n      return setPrototypeOf(namespace, imports);\n    })\n    .catch(r => console.warn(r) || namespace);\n\n  const apply = async (k, args) => {\n    const [n, ...p] = await Promise.all([imports, ...(await args)]);\n    return Reflect.apply(namespace[k] || noop, null, p);\n  };\n\n  const proxy = new Proxy(setPrototypeOf(new class Debugging {}(), null), {\n    get: (t, k) =>\n      (k &&\n        typeof k === 'string' &&\n        defineProperty(debugging, k, {\n          value: ƒ => apply(k, ƒ()),\n          configurable,\n        })[k]) ||\n      noop,\n  });\n\n  return setPrototypeOf(debugging, proxy);\n}\n\nexport default environment;\nexport {Log, CurrentScope, getWorker};\n"],"names":[],"mappings":"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"}